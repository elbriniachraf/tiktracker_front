<div class="product-list-container immersive-design">
    <button class="back-btn" (click)="goBack()"><i class="fas fa-arrow-left"></i> </button>

    <div class="toolbar">
      <input
        type="text"
        class="search-input"
        placeholder="üîç Rechercher une TVA..."
        [(ngModel)]="searchQuery"
        (input)="onSearch(searchQuery)"
      />
      <button class="btn btn-add" (click)="showAddTvaForm()">
        <fa-icon [icon]="'plus'"></fa-icon> Ajouter une TVA
      </button>
    </div>
  <!-- Drawer pour ajouter une TVA -->
<div class="drawer"  [class.open]="isDrawerOpen" (click)="closeDrawer()">
    <div class="drawer-content" (click)="$event.stopPropagation()">
      <div class="drawer-header">
        <h3>Ajouter une TVA</h3>
        <button (click)="closeDrawer()" class="close-btn">&times;</button>
      </div>
  
      <form (ngSubmit)="addTva()">
        <div class="form-group">
          <label for="country_code">Code Pays</label>
          <input type="text" id="country_code" [(ngModel)]="newTva.country_code" name="country_code" required>
        </div>
        
        <div class="form-group">
          <label for="label">Label</label>
          <input type="text" id="label" [(ngModel)]="newTva.label" name="label" required>
        </div>
        
        <div class="form-group">
          <label for="rate">Taux (%)</label>
          <input type="number" id="rate" [(ngModel)]="newTva.rate" name="rate" required>
        </div>
  
        <div class="form-group">
          <label for="category">Cat√©gorie</label>
          <input type="text" id="category" [(ngModel)]="newTva.category" name="category" required>
        </div>
        <div class="form-group">
            <label for="is_active">Actif</label>
            <input type="checkbox" id="is_active" [(ngModel)]="newTva.is_active" name="is_active">
          </div>
        <div class="form-group">
          <label for="valid_from">Valide √† partir de</label>
          <input type="date" id="valid_from" [(ngModel)]="newTva.valid_from" name="valid_from" required>
        </div>
  
        <div class="form-group">
          <label for="valid_to">Valide jusqu'√†</label>
          <input type="date" id="valid_to" [(ngModel)]="newTva.valid_to" name="valid_to">
        </div>
  
       
  
        <div class="form-actions">
          <button type="submit">Ajouter</button>
          <button type="button" (click)="closeDrawer()">Annuler</button>
        </div>
      </form>
    </div>
  </div>
  
    <ngx-datatable
      class="material"
      [rows]="filteredTvaRates"
      [columnMode]="'force'"
      [headerHeight]="60"
      [footerHeight]="60"
      [rowHeight]="'auto'"
      [limit]="pageSize"
      [scrollbarH]="true"
      [sorts]="sorts"
      (sort)="onSort($event)"
      [loadingIndicator]="loading"
      style="width: 100%; border-radius: 8px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);">
  
      <ngx-datatable-column name="#" [sortable]="false">
        <ng-template ngx-datatable-cell-template let-row="row" let-rowIndex="rowIndex">
          <strong>{{ rowIndex + 1 }}</strong>
        </ng-template>
      </ngx-datatable-column>
  
      <ngx-datatable-column name="Code Pays" prop="country_code" [sortable]="true">
        <ng-template let-value="value">
          <strong>{{ value }}</strong>
        </ng-template>
      </ngx-datatable-column>
  
      <ngx-datatable-column name="Label" prop="label" [sortable]="true">
        <ng-template let-value="value">
          {{ value }}
        </ng-template>
      </ngx-datatable-column>
  
      <ngx-datatable-column name="Taux (%)" prop="rate" [sortable]="true">
        <ng-template let-value="value">
          <div class="price">{{ value }}%</div>
        </ng-template>
      </ngx-datatable-column>
  
      <ngx-datatable-column name="Cat√©gorie" prop="category" [sortable]="true">
      </ngx-datatable-column>
  
      <ngx-datatable-column name="Statut" prop="is_active" [sortable]="true">
        <ng-template let-value="value">
          <span [class]="value ? 'badge bg-success' : 'badge bg-danger'">{{ value ? 'Actif' : 'Inactif' }}</span>
        </ng-template>
      </ngx-datatable-column>
  
      <ngx-datatable-column name="Valide √† partir de" prop="valid_from" [sortable]="true">
        <ng-template let-value="value">
          <div>{{ value | date:'dd/MM/yyyy' }}</div>
        </ng-template>
      </ngx-datatable-column>
  
      <ngx-datatable-column name="Valide jusqu'√†" prop="valid_to" [sortable]="true">
        <ng-template let-value="value">
          <div>{{ value ? (value | date:'dd/MM/yyyy') : 'N/A' }}</div>
        </ng-template>
      </ngx-datatable-column>
      <ngx-datatable-column name="Actions" [sortable]="false">
        <ng-template ngx-datatable-cell-template let-row="row">
          <div class="actions">
           
            <button class="btn btn-warning btn-sm" [routerLink]="['/edit-tva', row.id]">
                <fa-icon [icon]="'edit'"></fa-icon>
              </button>
              
              <button class="btn btn-danger btn-sm" (click)="deleteTva(row)">
                <fa-icon [icon]="'trash'"></fa-icon>
              </button>
            
          </div>
        </ng-template>
      </ngx-datatable-column>
  
    </ngx-datatable>
  
    <div class="pagination">
      <button (click)="onPreviousPage()">
        <fa-icon [icon]="'chevron-left'"></fa-icon>
      </button>
      <span>Page {{currentPage}} sur {{totalPages}}</span>
      <button (click)="onNextPage()">
        <fa-icon [icon]="'chevron-right'"></fa-icon>
      </button>
    </div>
  </div>
 